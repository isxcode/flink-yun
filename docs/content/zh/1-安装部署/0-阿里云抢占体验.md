---
title: "阿里云抢占体验"
---

## 使用阿里云抢占服务器体验至流云平台

#### 1. 抢占阿里云服务器

- 阿里云链接: https://ecs.console.aliyun.com/

> 选择`抢占式实例`，4核心8GB任意选择

![20241107174840](https://img.isxcode.com/picgo/20241107174840.png)

> 选择`Centos 7.9 64位`的系统版本

![20241107174937](https://img.isxcode.com/picgo/20241107174937.png)

> 注意！！安全组需要开放端口号: `8080`(访问端口必须开放，至流云默认端口号8080)

![20241107175038](https://img.isxcode.com/picgo/20241107175038.png)

> 获取服务器的`内网ip`和`外网ip`

![20241107184326](https://img.isxcode.com/picgo/20241107184326.png)

###### 系统信息如下

- 演示系统： Centos7.9
- 资源：4核8GB
- 外网ip：39.98.44.204
- 内网ip：172.25.28.232
- 账号：root
- 密码：Zhiliuyun123..

#### 2. 登录服务器

```bash
ssh root@39.98.44.204
```

![20241107175336](https://img.isxcode.com/picgo/20241107175336.png)

#### 3. 安装java环境(在线安装/推荐)

> Ubuntu系统，执行命令如下:   
> sudo apt update  
> sudo apt install openjdk-8-jdk openjdk-8-jre -y

```bash
sudo yum install java-1.8.0-openjdk-devel java-1.8.0-openjdk -y 
```

![20241107175441](https://img.isxcode.com/picgo/20241107175441.png)

#### 安装java环境(离线安装/可选)

```bash
cd /tmp
nohup wget https://openfly.oss-cn-shanghai.aliyuncs.com/java/zulu8.78.0.19-ca-jdk8.0.412-linux_x64.tar.gz >> download_jdk.log 2>&1 &
tail -f download_jdk.log
```

> 注意！！！一定要在~/.bashrc中配置JAVA_HOME环境变量

```bash
tar -vzxf /tmp/zulu8.78.0.19-ca-jdk8.0.412-linux_x64.tar.gz -C /opt
ln -s /opt/zulu8.78.0.19-ca-jdk8.0.412-linux_x64 /opt/java
tee -a ~/.bashrc <<-'EOF'
export JAVA_HOME=/opt/java
export PATH=$PATH:$JAVA_HOME/bin
EOF
source ~/.bashrc
java -version
```

#### 4. 下载至流云安装包

> 耐心等待下载，大约1GB大小的安装包

```bash
cd /tmp
nohup wget https://isxcode.oss-cn-shanghai.aliyuncs.com/zhiliuyun/zhiliuyun.tar.gz >> download_zhiliuyun.log 2>&1 &
tail -f download_zhiliuyun.log
```

![20241107175829](https://img.isxcode.com/picgo/20241107175829.png)

#### 5. 解压安装包

```bash
cd /tmp
tar -vzxf zhiliuyun.tar.gz
```

![20241107175903](https://img.isxcode.com/picgo/20241107175903.png)

#### 6. 启动至流云

```bash
cd /tmp/zhiliuyun/bin
bash start.sh
```

![20241107175922](https://img.isxcode.com/picgo/20241107175922.png)

#### 7. 检测服务是否启动

- 健康检测接口：http://39.98.44.204:8080/tools/open/health

![20241107180013](https://img.isxcode.com/picgo/20241107180013.png)

#### 8. 访问至流云服务

> 1M的带宽，首次加载，大约40s

- 访问接口：http://39.98.44.204:8080
- 管理员账号：`admin`
- 管理员密码：`admin123`

![20241107180143](https://img.isxcode.com/picgo/20241107180143.png)

#### 9. 创建用户租户

- 创建用户`zhiliuyun`
- 创建租户`体验租户`

![20250429160214](https://img.isxcode.com/picgo/20250429160214.png)

#### 10. 上传许可证

> 仅使用基础功能，不需要上传许可证  
> 可免费获取体验许可证，在官网的最下面

- 官网链接：https://zhiliuyun.isxcode.com/

![20241107180302](https://img.isxcode.com/picgo/20241107180302.png)

![20241107180345](https://img.isxcode.com/picgo/20241107180345.png)

#### 11. 添加计算集群

> 退出后台管理界面，使用`zhiliuyun`账号登录

![20241107180432](https://img.isxcode.com/picgo/20241107180432.png)

![20241107180447](https://img.isxcode.com/picgo/20241107180447.png)

> 选择StandAlone的集群类型

![20241107180518](https://img.isxcode.com/picgo/20241107180518.png)

![20241107180542](https://img.isxcode.com/picgo/20241107180542.png)

![20241107180557](https://img.isxcode.com/picgo/20241107180557.png)

> 推荐使用内网ip  
> host：172.25.28.232  
> 用户名： root  
> 密码： Zhiliuyun123..  
> 默认安装Flink：`打勾`

![20241107180738](https://img.isxcode.com/picgo/20241107180738.png)

![20241107180805](https://img.isxcode.com/picgo/20241107180805.png)

![20241107180818](https://img.isxcode.com/picgo/20241107180818.png)

![20241107180910](https://img.isxcode.com/picgo/20241107180910.png)

#### 13. 添加H2数据源

> 类型: `H2`  
> 链接信息: `jdbc:h2:file:~/.zhiliuyun/h2/data_test;AUTO_SERVER=TRUE`  
> 用户名: `root`  
> 密码: `zhiliuyun123`

![20241107181508](https://img.isxcode.com/picgo/20241107181508.png)

![20250429163300](https://img.isxcode.com/picgo/20250429163300.png)

![20250429163323](https://img.isxcode.com/picgo/20250429163323.png)

#### 13. 新建作业流

![20241107181655](https://img.isxcode.com/picgo/20241107181655.png)

![20241107181728](https://img.isxcode.com/picgo/20241107181728.png)

![20241107181740](https://img.isxcode.com/picgo/20241107181740.png)

#### 16. 新建Jdbc执行作业

> 选择h2数据源  
> 创建两张表，一张原始表一张结果表，并在原始表中插入一条数据据

```sql
-- 原始表
create table users(
    username varchar(100),
    sex int,
    birth datetime
);

-- 结果表
create table users_result(
    username varchar(100),
    sex int,
    birth varchar(100)
);

-- 结果表中插入一条数据
insert into users values('张三',13,now());
```

![20241107182223](https://img.isxcode.com/picgo/20241107182223.png)

![20241107182251](https://img.isxcode.com/picgo/20241107182251.png)

#### 17. 新建Jdbc查询作业

> 选择h2数据源  
> 通过jdbc查询作业，查看原始表中的数据。

```sql
select * from users;
```

![20241107182323](https://img.isxcode.com/picgo/20241107182323.png)

![20241107182349](https://img.isxcode.com/picgo/20241107182349.png)

#### 19. 使用自定义函数

> 自定义函数需要先上传编译的jar包到资源中心  
> 官方自定义函数模版： https://github.com/isxcode/flink-function-template

- 演示函数文件下载:  
https://isxcode.oss-cn-shanghai.aliyuncs.com/zhiliuyun/downloads/flink-custom-func.jar

- 演示依赖文件下载:  
https://isxcode.oss-cn-shanghai.aliyuncs.com/zhiliuyun/downloads/hutool-all-5.8.27.jar

![20241107182550](https://img.isxcode.com/picgo/20241107182550.png)

![20241107182712](https://img.isxcode.com/picgo/20241107182712.png)

![20241107182728](https://img.isxcode.com/picgo/20241107182728.png)

![20241107182737](https://img.isxcode.com/picgo/20241107182737.png)

#### 20. 新建自定义函数

![20241107182759](https://img.isxcode.com/picgo/20241107182759.png)

- 名称：to_chinese_date
- 类名：com.isxcode.acorn.udf.Func
- 备注：将时间格式转成中文

![20241107182853](https://img.isxcode.com/picgo/20241107182853.png)

![20241107182902](https://img.isxcode.com/picgo/20241107182902.png)

#### 21. 新建全局变量

![20250429165636](https://img.isxcode.com/picgo/20250429165636.png)

> H2_USERNAME: root

![20250429165707](https://img.isxcode.com/picgo/20250429165707.png)

> H2_PASSWORD: zhiliuyun123

![20250429165804](https://img.isxcode.com/picgo/20250429165804.png)

> 一键复制表达式
> ${{ secret.H2_USERNAME }}
> ${{ secret.H2_PASSWORD }}

![20250429170143](https://img.isxcode.com/picgo/20250429170143.png)

#### 21. 新建FlinkSql作业

> 使用FlinkSql作业，将原始表中的英文日期格式改成中文格式，并同步到结果表中。

```sql
CREATE TABLE from_table(
    username STRING,
    sex INT,
    birth Timestamp
) WITH (
    'connector'='jdbc',
    'url'='jdbc:h2:file:~/.zhiliuyun/h2/data_test',
    'driver'='org.h2.Driver',
    'table-name'='users',
    'username'='${{ secret.H2_USERNAME }}',
    'password'='${{ secret.H2_PASSWORD }}');

CREATE TABLE to_table(
    username STRING,
    sex INT,
    birth STRING
) WITH (
    'connector'='jdbc',
    'url'='jdbc:h2:file:~/.zhiliuyun/h2/data_test',
    'driver'='org.h2.Driver',
    'table-name'='users_result',
    'username'='${{ secret.H2_USERNAME }}',
    'password'='${{ secret.H2_PASSWORD }}'); 

insert into to_table ( username,sex,birth ) 
    select username, sex, to_chinese_date(birth) from from_table;
```

> 添加自定义函数to_chinese_date
> 添加函数依赖hutool-all-5.8.27.jar

![20250429170627](https://img.isxcode.com/picgo/20250429170627.png)

![20241107183339](https://img.isxcode.com/picgo/20241107183339.png)

>  使用jdbc查询作业，查看结果是否正确

```sql
select * from users_result;
```

![20241107183420](https://img.isxcode.com/picgo/20241107183420.png)

### 更多功能请看产品手册